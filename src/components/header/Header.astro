---
import Navbar from "./Navbar.astro";

import { LinksButton } from "./LinksButton";
---

<header class="w-full sticky top-0 z-50 p-4">
  <div class="max-w-6xl mx-auto flex items-center justify-between">
    <div class="flex gap-2 items-center">
      <a
        href="/"
        aria-labelledby="logo-link-label"
        class="rounded-full transition-all hover:shadow-lg hover:scale-125"
      >
        <span id="logo-link-label" class="hidden">Volver al inicio</span>
        <img
          class="size-12"
          aria-hidden="true"
          alt="Isotipo de Gaterapia"
          src="/gaterapia-isotype.webp"
        />
      </a>
    </div>

    <div class="flex items-center gap-3 text-white">
      <Navbar />
      <LinksButton className="hidden min-[350px]:flex" client:visible />
    </div>
  </div>
</header>

<style>
  header {
    animation: blur linear both;
    animation-timeline: scroll();
    animation-range: 0 500px;
  }

  @keyframes blur {
    to {
      box-shadow:
        0px 5px 50px -5px rgba(0, 0, 0, 0.1),
        0px 0px 0 1px rgba(0, 0, 0, 0.3);
      background: rgba(0, 0, 0, 0.3);
      backdrop-filter: blur(10px);
    }
  }
</style>

<script>
  const listItem = document.querySelectorAll("header ul li");
  const navbarBackdrop = document.querySelector(
    "#navbar-backdrop",
  ) as HTMLElement;

  listItem.forEach((item) => {
    item.addEventListener("mouseenter", () => {
      const { left, top, width, height } = item.getBoundingClientRect();

      navbarBackdrop.style.setProperty("--left", `${left}px`);
      navbarBackdrop.style.setProperty("--top", `${top}px`);
      navbarBackdrop.style.setProperty("--width", `${width}px`);
      navbarBackdrop.style.setProperty("--height", `${height}px`);

      navbarBackdrop.style.opacity = "1";
      navbarBackdrop.style.visibility = "visible";
    });

    item.addEventListener("mouseleave", () => {
      navbarBackdrop.style.opacity = "0";
      navbarBackdrop.style.visibility = "hidden";
    });
  });
</script>
